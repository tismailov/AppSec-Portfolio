# 007-BUFFER_OVERFLOW.LOOP

Тип задачи: Разметка сработки
Оценка: False Positive

Описание: Из-за зависимости условия цикла от значений элементов массива _PyOpcode_PseudoTargets[pseudo - 256].targets[i], цикл в pycore_opcode_metadata.h:1912 в функции is_pseudo_target может иметь неограниченное количество итераций, что в конечном итоге приведет к переполнению буфера.

```c
for (int i = 0; _PyOpcode_PseudoTargets[pseudo-256].targets[i]; i++) {
```

Анализ сработки:

1. Структура pseudo_targets определена с фиксированным размером массива:

```c
struct pseudo_targets {
uint8_t targets[3];
};
```

2. Все элементы массива _PyOpcode_PseudoTargets инициализированы с явным завершающим нулевым элементом:

```c
const struct pseudo_targets _PyOpcode_PseudoTargets[12] = {
[LOAD_CLOSURE-256] = { { LOAD_FAST, 0, 0 } },
[JUMP-256] = { { JUMP_FORWARD, JUMP_BACKWARD, 0 } },
[SETUP_FINALLY-256] = { { NOP, 0, 0 } },
// ... остальные инициализации следуют тому же паттерну
};
```

1. Каждая инициализация гарантирует наличие нулевого элемента:
- Массивы с одним опкодом: { OPCODE, 0, 0 }
- Массивы с двумя опкодами: { OPCODE1, OPCODE2, 0 }

Цикл использует null-terminated array pattern, аналогичный работе с C-строками: он продолжается, пока элемент массива ненулевой, и останавливается при встрече нулевого элемента. Благодаря инициализации с завершающими нулями, максимальное количество итераций ограничено размером массива (3 элемента), что исключает возможность выхода за границы буфера и бесконечного цикла.

Вердикт: False Positive